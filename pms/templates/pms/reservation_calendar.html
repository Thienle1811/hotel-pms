{% extends 'pms/base.html' %}

{% block title %}{{ page_title }}{% endblock %}

{% block extra_css %}
  .status-Occupied { color: #dc3545; font-weight: bold; }
  .status-Confirmed { color: #ffc107; font-weight: bold; }
{% endblock %}

{% block content %}
  <h2>{{ page_title }}</h2>

  <table>
    <thead>
      <tr>
        <th>Phòng</th>
        <th>Khách hàng</th>
        <th>Trạng thái</th>
        <th>Check-in</th>
        <th>Check-out Dự kiến</th>
        <th>Ghi chú</th>
        <th>Hành động</th>
      </tr>
    </thead>
    <tbody>
      {% for res in reservations %}
      <tr>
        <td>P. <strong>{{ res.room.room_number }}</strong></td>
        <td>{{ res.guest.full_name }}</td>
        <td class="status-{{ res.status }}">
            {{ res.get_status_display }}
        </td>
        <td>{{ res.check_in_date|date:"H:i d/m/Y" }}</td>
        <td>
            {% if res.check_out_date %}
                {{ res.check_out_date|date:"H:i d/m/Y" }}
            {% else %}
                (Chưa xác định)
            {% endif %}
        </td>
        <td>{{ res.note|default:"---" }}</td>
        <td>
            {% if res.status == 'Confirmed' %}
                <a href="{% url 'perform-check-in' res.id %}" style="color: #007bff;">Check-in</a>
            {% elif res.status == 'Occupied' %}
                <a href="{% url 'perform-check-out' res.id %}" style="color: #dc3545;">Check-out</a> | 
                <a href="{% url 'manage-room-services' res.id %}" style="color: #28a745;">Dịch vụ</a>
            {% endif %}
        </td>
      </tr>
      {% empty %}
      <tr>
        <td colspan="7">Không có Booking hoặc khách đang ở nào.</td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
{% endblock %}